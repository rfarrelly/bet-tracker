<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saved Bets</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900">
    <div class="container mx-auto p-6">

        <!-- Header with navigation -->
        <div class="flex items-center justify-between mb-6">
            <h1 class="text-3xl font-bold">Saved Bets</h1>
            <a href="/fixtures" class="text-blue-500 hover:underline">← Back to Fixtures</a>
        </div>

        <!-- Filter Form -->
        <form method="GET" action="/bets" class="mb-6 flex flex-wrap gap-4">
            <select name="bet_type" class="border p-2 rounded">
                <option value="">All Bet Types</option>
                <option value="single" {% if request.args.get('bet_type') == 'single' %}selected{% endif %}>Single</option>
                <option value="accumulator" {% if request.args.get('bet_type') == 'accumulator' %}selected{% endif %}>Accumulator</option>
            </select>

            <input type="text" name="user_id" placeholder="User ID" class="border p-2 rounded" value="{{ request.args.get('user_id', '') }}">

            <input type="date" name="date" class="border p-2 rounded" value="{{ request.args.get('date', '') }}">

            <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">Filter</button>
        </form>

        <!-- Bets Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for bet in bets %}
                {% if bet.bet_type == "single" %}
                    {% for selection in bet.selections %}
                    <div class="bg-white shadow-md rounded-lg p-4 border border-gray-200">
                        <h2 class="text-xl font-semibold text-gray-800">Single Bet</h2>
                        <p class="text-gray-500 text-sm">User ID: {{ bet.user_id }}</p>

                        <div class="mt-2">
                            <p><strong>Stake:</strong> £{{ bet.stake }}</p>
                            <p><strong>Odds:</strong> {{ bet.odds }}</p>
                        </div>

                        <div class="mt-2">
                            <p><strong>Match:</strong> {{ selection.home }} vs {{ selection.away }}</p>
                            <p><strong>Selection:</strong> {{ selection.market | capitalize }}</p>
                        </div>

                        <div class="mt-3 flex justify-between items-center">
                            <span class="px-3 py-1 rounded-full text-xs font-semibold
                                {% if bet.status == 'Won' %}
                                    bg-green-100 text-green-600
                                {% elif bet.status == 'Lost' %}
                                    bg-red-100 text-red-600
                                {% else %}
                                    bg-gray-200 text-gray-800
                                {% endif %}">
                                {{ bet.status }}
                            </span>

                            <p class="text-gray-400 text-sm">{{ bet.timestamp }}</p>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <!-- Accumulator Bets -->
                    <div class="bg-white shadow-md rounded-lg p-4 border border-gray-200">
                        <h2 class="text-xl font-semibold text-gray-800">Accumulator</h2>
                        <p class="text-gray-500 text-sm">User ID: {{ bet.user_id }}</p>

                        <div class="mt-2">
                            <p><strong>Stake:</strong> £{{ bet.stake }}</p>
                            <p><strong>Odds:</strong> {{ "%.2f"|format(bet.odds) }}</p>
                        </div>

                        <div class="mt-2">
                            <p><strong>Selections:</strong></p>
                            <ul>
                                {% for selection in bet.selections %}
                                <li>
                                    <p><strong>Match:</strong> {{ selection.home }} vs {{ selection.away }}</p>
                                    <p><strong>Selection:</strong> {{ selection.market | capitalize }} (Odds: {{ selection.odds }})</p>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>

                        <div class="mt-3 flex justify-between items-center">
                            <span class="px-3 py-1 rounded-full text-xs font-semibold
                                {% if bet.status == 'Won' %}
                                    bg-green-100 text-green-600
                                {% elif bet.status == 'Lost' %}
                                    bg-red-100 text-red-600
                                {% else %}
                                    bg-gray-200 text-gray-800
                                {% endif %}">
                                {{ bet.status }}
                            </span>

                            <p class="text-gray-400 text-sm">{{ bet.timestamp }}</p>
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
        </div>

    </div>
</body>
</html>
